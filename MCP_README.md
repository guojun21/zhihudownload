# ğŸ¬ çŸ¥ä¹è§†é¢‘ä¸‹è½½å™¨ - MCP æœåŠ¡ç³»ç»Ÿ

## âœ… å®Œæˆçš„åŠŸèƒ½

### 1ï¸âƒ£ æ ¸å¿ƒåŠŸèƒ½

âœ“ **ä¸‹è½½è§†é¢‘** - ä¸‹è½½çŸ¥ä¹è§†é¢‘ä¸º MP4ï¼ˆé»˜è®¤æœ€é«˜æ¸…æ™°åº¦ï¼‰
âœ“ **è½¬å½•è§†é¢‘** - å°†è§†é¢‘è½¬å½•ä¸ºæ–‡æœ¬ï¼ˆè‡ªåŠ¨æå–éŸ³é¢‘ + Whisperï¼‰
âœ“ **è¿›åº¦ç›‘æ§** - å®æ—¶æŸ¥çœ‹ä¸‹è½½å’Œè½¬å½•çš„è¿›åº¦

---

## ğŸ“¦ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ· / å¤–éƒ¨åº”ç”¨                            â”‚
â”‚     (Cursor / Python / Shell / HTTP Client)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  MCP æœåŠ¡å™¨            â”‚
        â”‚  (Go - 5125 ç«¯å£)      â”‚
        â”‚                        â”‚
        â”‚  3 ä¸ªå¯ç”¨å·¥å…·:         â”‚
        â”‚  â€¢ download_video      â”‚
        â”‚  â€¢ transcribe_video    â”‚
        â”‚  â€¢ get_progress        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â–¼              â–¼              â–¼
   FFmpeg        Whisper        è¿›åº¦ç®¡ç†
   (ä¸‹è½½)        (è½¬å½•)         (å®æ—¶)
```

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### 1. å¯åŠ¨ MCP æœåŠ¡

```bash
cd /Users/oasmet/Documents/!002Projects/03-media-processing/ZhihuDownloader
./mcp-server
```

æœåŠ¡åœ¨ `http://127.0.0.1:5125` ç›‘å¬

### 2. ä½¿ç”¨ Python å®¢æˆ·ç«¯

```bash
# å®Œæ•´å·¥ä½œæµï¼ˆä¸‹è½½ + è½¬å½•ï¼‰
python3 mcp_client.py full "http://zhihu.com/xen/market/..." zh

# åªä¸‹è½½
python3 mcp_client.py download "http://zhihu.com/xen/market/..." ~/Downloads

# åªè½¬å½•
python3 mcp_client.py transcribe /path/to/video.mp4 zh

# æŸ¥çœ‹è¿›åº¦
python3 mcp_client.py progress <task_id> download
python3 mcp_client.py progress <task_id> transcribe
```

### 3. ä½¿ç”¨ curl è°ƒç”¨ API

```bash
# ä¸‹è½½è§†é¢‘
curl -X POST http://127.0.0.1:5125/mcp/call_tool \
  -H "Content-Type: application/json" \
  -d '{
    "name": "download_video",
    "input": {
      "url": "http://zhihu.com/xen/market/...",
      "output_path": "/Users/oasmet/Downloads"
    }
  }'

# è½¬å½•è§†é¢‘
curl -X POST http://127.0.0.1:5125/mcp/call_tool \
  -H "Content-Type: application/json" \
  -d '{
    "name": "transcribe_video",
    "input": {
      "video_path": "/Users/oasmet/Downloads/video.mp4",
      "language": "zh"
    }
  }'

# æŸ¥çœ‹è¿›åº¦
curl -X POST http://127.0.0.1:5125/mcp/call_tool \
  -H "Content-Type: application/json" \
  -d '{
    "name": "get_progress",
    "input": {
      "task_id": "<task_id>",
      "task_type": "download"
    }
  }'
```

---

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | åŸå§‹ REST API | MCP æœåŠ¡ |
|------|---------------|---------|
| ä¸‹è½½è§†é¢‘ | âœ“ | âœ“ |
| è½¬å½•è§†é¢‘ | âœ“ | âœ“ |
| æŸ¥çœ‹è¿›åº¦ | âœ“ | âœ“ |
| **æ˜“ç”¨æ€§** | REST è°ƒç”¨ | **æ ‡å‡†åŒ–å·¥å…·è°ƒç”¨** |
| **é›†æˆ** | HTTP åº“ | **Cursor/Claude åŸç”Ÿ** |
| **æŠ½è±¡åº¦** | ä½ | **é«˜** |

---

## ğŸ”Œ ä¸ Cursor/Claude é›†æˆ

### æ–¹æ³• 1: é€šè¿‡ MCP é…ç½®

åœ¨ Cursor è®¾ç½®ä¸­ï¼ˆå¦‚æœæ”¯æŒ MCPï¼‰ï¼š

```json
{
  "mcpServers": {
    "zhihu-downloader": {
      "command": "bash",
      "args": [
        "-c",
        "cd /Users/oasmet/Documents/!002Projects/03-media-processing/ZhihuDownloader && ./mcp-server"
      ]
    }
  }
}
```

ç„¶ååœ¨ Cursor ä¸­ä½¿ç”¨ï¼š
```
@claude å¸®æˆ‘ä¸‹è½½å’Œè½¬å½•è¿™ä¸ªçŸ¥ä¹è§†é¢‘: http://zhihu.com/...
```

### æ–¹æ³• 2: é€šè¿‡ Python è„šæœ¬

Cursor å¯ä»¥ç›´æ¥è°ƒç”¨ Python è„šæœ¬ï¼š
```bash
python3 /Users/oasmet/Documents/!002Projects/03-media-processing/ZhihuDownloader/mcp_client.py \
  full "http://zhihu.com/xen/market/..." zh
```

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `mcp_server.go` | MCP æœåŠ¡å®ç°ï¼ˆGoï¼‰ |
| `mcp_client.py` | MCP å®¢æˆ·ç«¯ï¼ˆPythonï¼‰ |
| `mcp-server` (äºŒè¿›åˆ¶) | ç¼–è¯‘åçš„æœåŠ¡å¯æ‰§è¡Œæ–‡ä»¶ |
| `MCP_GUIDE.md` | è¯¦ç»†ä½¿ç”¨æ–‡æ¡£ |

---

## âš¡ æ€§èƒ½æŒ‡æ ‡

| æ“ä½œ | è€—æ—¶ |
|------|------|
| MP4 ä¸‹è½½ (276MB) | ~2-5 åˆ†é’Ÿ |
| éŸ³é¢‘æå– (ffmpeg) | ~1-2 åˆ†é’Ÿ |
| è¯­éŸ³è½¬å½• (Whisper) | ~20-30 åˆ†é’Ÿ |
| **æ€»è€—æ—¶** | **~25-35 åˆ†é’Ÿ** |

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Go (Gin æ¡†æ¶)
- **å®¢æˆ·ç«¯**: Python (requests)
- **å¤„ç†å·¥å…·**: FFmpeg, Whisper
- **åè®®**: JSON-RPC / REST API
- **å¹¶å‘**: goroutines + mutex

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **åå°è¿è¡Œ**: å¯åŠ¨ MCP æœåŠ¡åå¯ä»¥é•¿æœŸä¿æŒè¿è¡Œ
2. **ç›‘æ§è¿›åº¦**: å®šæœŸæŸ¥è¯¢è¿›åº¦ï¼Œè€Œä¸æ˜¯è½®è¯¢
3. **é”™è¯¯å¤„ç†**: ä»»åŠ¡å¤±è´¥æ—¶æ£€æŸ¥ error å­—æ®µ
4. **å¹¶å‘ä»»åŠ¡**: æ”¯æŒå¤šä¸ªä¸‹è½½/è½¬å½•ä»»åŠ¡åŒæ—¶è¿›è¡Œ
5. **å­˜å‚¨ç©ºé—´**: é¢„ç•™è‡³å°‘ 1GB ç©ºé—´ç”¨äºä¸´æ—¶æ–‡ä»¶

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å¦‚éœ€è¿›ä¸€æ­¥å¢å¼ºï¼Œå¯ä»¥è€ƒè™‘ï¼š
- [ ] æ·»åŠ è§†é¢‘è´¨é‡é€‰æ‹©æ¥å£
- [ ] å®ç°è½¬å½•è¿›åº¦ç»†åˆ†ï¼ˆ0-100%ï¼‰
- [ ] æ”¯æŒæ‰¹é‡ä¸‹è½½/è½¬å½•
- [ ] æ·»åŠ æ–‡ä»¶æ¸…ç†æ¥å£
- [ ] å®ç°æŒä¹…åŒ–ä»»åŠ¡é˜Ÿåˆ—

---

